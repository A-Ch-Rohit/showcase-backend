<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%=itm.name%> - Showcase</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="https://firebasestorage.googleapis.com/v0/b/showcase-7121e.appspot.com/o/logo%2FShowCase%20logo-modified.ico?alt=media&token=1cb0428c-bfbf-4801-9c1a-32ab9e016fa4">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
      .profile-edit-btn {
        display: inline-block;
        font: inherit;
        background: none;
        border: none;
        color: inherit;
        padding: 0;
        cursor: pointer;
      }

      .visually-hidden {
        position: absolute !important;
        height: 1px;
        width: 1px;
        overflow: hidden;
        clip: rect(1px, 1px, 1px, 1px);
      }

      /* Profile Section */

      .profile {
        padding: 5rem 0;
      }

      .profile::after {
        content: "";
        display: block;
        clear: both;
      }

      .profile-image {
        float: left;
        width: calc(33.333% - 1rem);
        display: flex;
        justify-content: center;
        align-items: center;
        margin-right: 3rem;
        padding-top: 3%;
      }

      .profile-image img {
        border-radius: 50%;
      }

      .profile-user-settings,
      .profile-stats,
      .profile-bio {
        float: left;
        width: calc(66.666% - 2rem);
      }

      .profile-user-settings {
        margin-top: 1.1rem;
      }

      .profile-user-name {
        display: inline-block;
        font-size: 2.5rem;
        font-weight: 300;
      }

      .profile-edit-btn {
        font-size: 1.4rem;
        line-height: 1.2;
        border: 0.3rem solid #dbdbdb;
        border-radius: 0.6rem;
        padding: 0 2.4rem;
        margin-left: 2rem;
      }

      .profile-settings-btn {
        font-size: 2rem;
        margin-left: 1rem;
      }

      .profile-stats {
        margin-top: 2.0rem;
      }

      .profile-stats li {
        display: inline-block;
        font-size: 1.3rem;
        line-height: 1.0;
        margin-right: 4rem;
        cursor: pointer;
      }

      .profile-stats li:last-of-type {
        margin-right: 0;
      }

      .profile-bio {
        font-size: 18px;
        font-weight: 400;
        line-height: 1.0;
        margin-top: 2.0rem;
      }

      .profile-real-name,
      .profile-stat-count,
      .profile-edit-btn {
        font-weight: 600;
      }   

  </style>
</head>
<body>
    <%- include('partials/header.ejs'); %>

    <section class="profile-back" style="background-color: #F4F4F2;">
      <div class="profie-info">
          <div class="container">
              <div class="profile">
                  <div class="profile-image">
                      <% if(itm.picture!==""){%>
                          <img class="profile-picture" src='<%- itm.picture %>' style="border-radius: 100%;"/>
                      <%}else{%>
                      <i class="material-icons">account_circle</i>
                      <%}%>
      
                  </div>
      
                  <div class="profile-user-settings">
      
                      <h1 class="profile-user-name"><%=itm.name%></h1>
      
                  <!--    <a href="/account/edit" class="btn profile-edit-btn">Edit Profile</a>
      
                      <button class="btn profile-settings-btn" aria-label="profile settings"><i class="fas fa-cog" aria-hidden="true"></i></button>-->
      
                  </div>
      
                  <div class="profile-stats">
      
                      <ul>
                          <li class="vid-count"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path d="M6 0C2.7 0 0 2.7 0 6C0 9.3 2.7 12 6 12C9.3 12 12 9.3 12 6C12 2.7 9.3 0 6 0ZM6 11.25C3.1 11.25 0.75 8.9 0.75 6C0.75 3.1 3.1 0.75 6 0.75C8.9 0.75 11.25 3.1 11.25 6C11.25 8.9 8.9 11.25 6 11.25ZM8.5 5.35L5.1 3.4C4.85 3.25 4.6 3.25 4.35 3.4C4.15 3.55 4 3.75 4 4.05V7.95C4 8.2 4.15 8.45 4.4 8.6C4.5 8.65 4.65 8.7 4.8 8.7C4.95 8.7 5.05 8.65 5.2 8.6L8.6 6.65C8.85 6.5 9 6.25 9 6C9 5.75 8.75 5.5 8.5 5.35ZM4.75 7.95V4.05L8.15 6L4.75 7.95Z" fill="#0B1514"/>
                              </svg>
                              <span class="profile-stat-count"><%=my_products.length%></span> <p class="p-vid">videos</p></li>
                          <!--<li><span class="profile-stat-count">188</span> followers</li>
                          <li><span class="profile-stat-count">206</span> following</li>-->
                      </ul>
                      <%if(user.name!==undefined && sub.length!==0){%>
                        <%if((sub.subscribers).length>0){%>
                          <% for(let i=0;i<(sub.subscribers).length;i++){if(sub.subscribers[i]===user.email){%>
                          <form action="/unsubscribe" method="post">
                            <input type="text" value="<%-itm.email%>" name="prof_email" style="display:none">
                            <input type="text" value="<%-user.email%>" name="sub_email" style="display:none">
                            <button type="submit" class="btn btn-info btn-block" title="Unsubscribe">Subscribed</button>
                          </form>
                        <%}}}else{%>
                          <form action="/subscribe" method="post">
                            <input type="text" value="<%-itm.email%>" name="prof_email" style="display:none">
                            <input type="text" value="<%-user.email%>" name="sub_email" style="display:none">
                            <button type="submit" class="btn btn-outline-info btn-block">Subscribe</button>
                          </form>
                        <%}%>
                            
                       <% }else if(user.name!==undefined && sub.length===0){%>
                        <form action="/subscribe" method="post">
                          <input type="text" value="<%-itm.email%>" name="prof_email" style="display:none">
                          <input type="text" value="<%-user.email%>" name="sub_email" style="display:none">
                          <button type="submit" class="btn btn-outline-info btn-block">Subscribe</button>
                        </form>
                       <%}else{ %>
                        <a href="/login" class="btn btn-outline-info btn-block">Subscribe</a>
                      <%}%>
                  </div>
      
                  <div class="profile-bio">
                      <% if(itm.bio&&itm.bio!==undefined){%>
                        <% var bio=(itm.bio).split('\n');var b="";for(let i=0;i < bio.length;i++){ %>
                        <p><%=bio[i]%></p>
                      <%}}else{%>
                      <p></p>
                      <%}%>
      
                  </div>
              </div>
              <!-- End of profile section -->
      
              
          </div>
          <!-- End of container -->
      
      </div>
  </section>
  <div class="post-video container" style="padding-top: 75px;">

    <div class="row">
        <% var i=0; if(!my_products.pdt_brand){ my_products.forEach((item)=>{%>
        <div class="each-post col-md-3 col-sm-6">
            <video class="each-video" id="p-video">
                <source
                        src="<%-item.pdt_video %>"
                        type="video/mp4"
                      />
            </video>

            <a class="vid-play" id="<%-item.pdt_video %>" onclick="video(event)"><i class=" fas fa-play"></i></a>
            <div class="video-menu dropdown">

                <a href="#" class="nav-link dropdown-toggle" id="editdrop" data-toggle="dropdown">
                    <i class="drop-icon fas fa-ellipsis-v"></i>
                </a>
                <div class="vi-menu dropdown-menu">
                    <% let p_code,link="#";wtp.forEach((b)=>{ if(b.email===item.company_email){let p_code=(b.code).split("+");link="http://wa.me/"+p_code[1]+b.whatsapp;}})%>
                    <a href="<%-link%>" class="dropdown-item"><i class="fab fa-whatsapp" style="padding-right: 10px;"></i>Whatsapp</a>
                    <%let gps="#";wtp.forEach((b)=>{ if((b.email===item.company_email) &&b.location!==undefined){gps="https://www.google.com/maps/dir//"+b.location[0]+","+b.location[1];}})%>
                    <a href="<%-gps%>" class="dropdown-item"><i class="fas fa-location" style="padding-right: 10px;"></i>Store Location</a>
                    <%if(user.type==="personal"){%>
                        <form method="post" action="/save-video">
                        <input type="text" name="video_comp" value="<%-item.company_name%>" style="display:none" required>
                        <input type="text" name="video_email" value="<%-item.company_email%>" style="display:none" required>
                        <input type="text" name="video_brand" value="<%-item.pdt_brand%>" style="display:none" required>
                        <input type="text" name="video_type" value="<%-item.pdt_type%>" style="display:none" required>
                        <input type="text" name="video_category" value="<%-item.pdt_category%>" style="display:none" required>
                        <input type="text" name="video_amt" value="<%-item.pdt_amt%>" style="display:none" required>
                        <textarea type="text" name="video_description" style="display:none" ><%-item.pdt_description%></textarea>
                        <input type="text" name="video_link" value="<%-item.pdt_video%>"  style="display:none" required>
                    <button type="submit" class="dropdown-item"><i class="fas fa-save" style="padding-right: 10px;"></i>Save</button>
                    </form>
                    <%}else{%>
                    <a href="/login" class="dropdown-item"><i class="fas fa-save" style="padding-right: 10px;"></i>Save</a>
                    <%}%>
                </div>
            </div>
        </div>
        <%i++;})}else{%>
            <div class="no-posts">
                <h3 class="container" style="text-align: center;">No Videos</h3>
            </div>
            <%}%>
    </div>
  </div>
  <div id="Videonav" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="video_close()"  ontouchend="video_close()">&times;</a>
    <div class="container">
      <div class="row">
        <div class="video-col col-md-6">
          <video class="view-video d-flex" id="play-vid" autoplay controls>
            <source
                    type="video/mp4"
                  />
        </video>
        </div>
        <div class="col-md-6">
          <div class="v-content container-md">
            <div class="d-row row">
              <div class="vi-content col-md-9">
                <p id="u_comp">Company Name</p>
                <h3 id="u_brand">Brand</h3>
              </div>
              <div class="col-md-3">
                <div class="price">
                  <p id="u_amt">Rs. Amount</p>
                </div>
              </div>
            </div>
            <div class="row">
              <div clas="container col-md-3">
                <p class="dp" id="u_dp">Description</p>
              </div>
            </div>
            <div class="bt d-flex" style=" padding-bottom: 78px;">
                <a class="video-btn" id="what" href="#" style="text-decoration: none;"><p class="btn-text">WhatsApp</p><p class="btn-small">Contact on Whatsapp</p></a>
              <a class="video-btn" id="location" href="#" style="text-decoration: none;"><p class="btn-text">GPS</p><p class="btn-small">Look for direction</p></a>
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>
  <script>
       function video(e){
            var cp,br,gp,amt,dp,l;
            if(e.target.id!==""){
                '<% my_products.forEach((item)=>{%>'
                if(e.target.id==='<%-item.pdt_video%>'){
                  '<% let p_code,link="#";wtp.forEach((itm)=>{ if(itm.email===item.company_email){let p_code=(itm.code).split("+");link="http://wa.me/"+p_code[1]+itm.whatsapp;}})%>'
                  ' <%let gps="#";wtp.forEach((itm)=>{ if((itm.email===item.company_email) &&itm.location!==undefined){gps="https://www.google.com/maps/dir//"+itm.location[0]+","+itm.location[1];}})%>'
                  cp='<%-item.company_name%>'
                    br='<%-item.pdt_brand%>';
                    amt='Rs.<%-item.pdt_amt%>';
                    dp=`<%- item.pdt_description %>`;
                    l='<%-link%>';
                    gp='<%-gps%>';
                    '<%var desm=""; if(item.pdt_description&&item.pdt_description!==undefined){%>'
                              '<% var des=(item.pdt_description).split("\n");var b="";for(let i=0;i < des.length;i++){desm=des[i]+"<br/>"%>'
                            '<%}}%>'
                    document.getElementById("u_comp").textContent =cp;
                    document.getElementById("u_brand").textContent =br; 
                    document.getElementById("u_amt").textContent=amt; 
                    document.getElementById("u_dp").textContent =dp;
                    document.getElementById("what").href = l;
                    document.getElementById("location").href = gp;
                    document.getElementById("play-vid").src='<%-item.pdt_video%>';

                }
                '<%})%>'
               document.getElementById("Videonav").style.height = "85%";
               document.getElementById('plus-upload').style.display="none";
            }
      
        }
        function video_close(){
        document.getElementById("Videonav").style.height = "0";
        document.getElementById("play-vid").pause();
   }
    function del(e){
       if(e.target.id!=='')
       {
        document.getElementById('d-yes').disabled=false;
        document.getElementById('d-no').disabled=false;
        document.getElementById("del-vid").value =e.target.id; 
        document.getElementById("Deletenav").style.height = "25%";
       }
   }
   function delete_close(){
        document.getElementById('d-yes').disabled=false;
        document.getElementById("Deletenav").style.height = "0";
   }
   function remove_vid()
    {
        if(document.getElementById('del-vid').value!==""){
            document.getElementById('d-yes').disabled=true;
            document.getElementById('d-no').disabled=true;
            alert("Video Deleted");    
            document.getElementById("d-submit").click();
        }
  
    
    }
  </script>      

<br>
<br>
<br>
<br>
<br>
      <%- include('partials/footer.ejs'); %>


</body>
</html>